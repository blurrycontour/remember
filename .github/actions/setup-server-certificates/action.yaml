name: "Setup Certificates"

description: "Setup Certificates on remote VMs"

inputs:
  ssh_host:
    description: "SSH Host"
    default: "remote"
    required: false

runs:
  using: "composite"
  steps:
    - name: Create mongodb CA certificate
      shell: bash
      run: |
        ssh ${{ inputs.ssh_host }} """
          cd $REPO_NAME
          mkdir -p certs/mongodb
          echo "$MONGO_CERT_CA_PEM" > certs/mongodb/ca.pem
        """
    - name: Create mongodb server certificate
      shell: bash
      run: |
        ssh ${{ inputs.ssh_host }} """
          cd $REPO_NAME
          mkdir -p certs/mongodb
          echo "$MONGO_CERT_SERVER_PEM" > certs/mongodb/mongodb.pem
        """
